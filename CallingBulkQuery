

from SalesforceScripts import *
from SalesforceBulkQuery import *

sfbulk = SalesforceBulk(sessionId=sf.session_id, host=sf.sf_instance)


def SFBulkQuery(SObject, SOQL):
    job = sfbulk.create_query_job(SObject, contentType='CSV')
    batch = sfbulk.query(job, SOQL)
    while not sfbulk.is_batch_done(job, batch):
        time.sleep(10)
    sfbulk.close_job(job)
    res = sfbulk.get_batch_result_iter(job, batch)
    return res

